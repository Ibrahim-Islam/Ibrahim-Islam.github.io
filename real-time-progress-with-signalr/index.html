<!DOCTYPE html>
<html>

	<head>

		
		<meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		
		<title>Real-Time Progress With SignalR</title>
		<meta name="description" content="" />
		
		<link rel="stylesheet" type="text/css" href="../assets/css/style.css" />
		<link rel="stylesheet" type="text/css" href="../assets/css/normalize.css" />

		<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,400,300,600,700,800|Exo+2:400,100,200,300,500,600,700,800' rel='stylesheet' type='text/css'>
		
		<meta name="HandheldFriendly" content="True" />
		<meta name="MobileOptimized" content="320" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link href="../assets/css/prism.css" rel="stylesheet"></link> 
		<meta name="generator" content="Ghost 0.5" />
<link rel="alternate" type="application/rss+xml" title="" href="../rss/index.html">
<link rel="canonical" href="http://my-ghost-blog.com/real-time-progress-with-signalr/" />

	</head>

	<body class="post-template tag-signalr">

		<div class="wrapper_pixel">

			

<div role='banner' class="header_pixel">

	<div class="menu_list">
		<a class="menu_item" href="http://bd.linkedin.com/in/mdibrahimislam/">LinkedIn</a>
		<a class="menu_item" href="http://stackoverflow.com/users/1565402/md-lbrahim">StackOverflow</a>
		<a class="menu_item" href="http://forums.asp.net/members/IbrahimIslam.aspx">ASP.NET</a>
		<a class="menu_item" href="https://github.com/Ibrahim-Islam">GitHub</a>
		<a class="menu_item" href="mailto:ibrahim.islam@live.com">Email</a>
	</div>

	<a class="" href="../index.html"><img class="cover_pixel" src="../content/images/2014/Sep/cover.png" alt="" /></a>

	<h1 class="blogtitle_pixel">

		<a title="" href='http://my-ghost-blog.com'>

			

		</a>

	</h1>

	<p class="blogdescription_pixel">

		<a title="" href='http://my-ghost-blog.com'>

			

		</a>

	</p>

</div>

<main class="main_pixel post" role="main">

	
		
		<div id="trampezium"></div>

		<article class="article_pixel" role="article" itemscope itemtype="http://schema.org/Article" style="display:table;">
		
			<header class="postheader_pixel">

				<time class="date_pixel" datetime="2015-01-28" itemprop="datePublished">

					<span class="icon-clock"></span>Wednesday 28 Jan 2015

				</time>

				<h1 class="posttitle_pixel" itemprop="headline">

					Real-Time Progress With SignalR

				</h1>
				
			</header>

			<div class="postcontent_pixel" itemprop="articleBody">

				<p>All of a sudden I had an urge to try out a progress bar that actually shows progress in terms if numbers in a web application instead of an indefinite kind. So, tried it out with SignalR and it was a breeze to implement. I did not understand much of its stuff though.</p>

<p>I decided to use Bootstrap for the progress bar and ASP.NET MVC to serve the HTML. Following is what my HTML looks like:</p>

<pre><code class="language-markup">&lt;div class="container"&gt;  
    &lt;p class="row"&gt;
        &lt;div class="progress"&gt;
            &lt;div id="progress-bar" class="progress-bar" role="progressbar" aria-valuenow="2" 
                 aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: 0%;"&gt;0%&lt;/div&gt;
        &lt;/div&gt;
    &lt;/p&gt;
    &lt;button id="start-processing" type="button" 
            class="btn btn-primary col-md-offset-5"&gt;Start Processing&lt;/button&gt;
&lt;/div&gt;  
</code></pre>

<p>One <em>odd</em> thing I had to do was reference an automatic generated script by SignalR for my hub and the result of my JS script references looked like below:</p>

<pre><code class="language-markup">&lt;script src="~/Scripts/jquery-2.1.3.min.js"&gt;&lt;/script&gt;  
&lt;script src="~/Scripts/bootstrap.min.js"&gt;&lt;/script&gt;  
&lt;script src="~/Scripts/jquery.signalR-2.2.0.min.js"&gt;&lt;/script&gt;  
&lt;script src="~/signalr/hubs"&gt;&lt;/script&gt;  
</code></pre>

<p>Like MVC and WebAPI, the mapping for SignalR has to be done and it is done in an OWIN Startup class:</p>

<pre><code class="language-csharp">public class Startup  
{
    public void Configuration(IAppBuilder app)
    {
        app.MapSignalR();
    }
}
</code></pre>

<p>Now, we can create the endpoint where the request will be actually hit and these are done in classes that are inherited from <strong>Hub</strong>:</p>

<pre><code class="language-csharp">public class ProgressHub : Hub  
{
    public void Send()
    {
        int total = 10;
        for (int i = 1; i &lt;= total; i++)
        {
            //simulate work
            Thread.Sleep(2000);
            //send the progress
            Clients.Caller.updateProgress(Decimal.Divide(i, total) * 100);
        }
    }
}
</code></pre>

<p>It is not that different from Controller-Action scenario. We can inject our required services/repositories here to do actual stuff and update subscribers accordingly.</p>

<p>Following is code that initiates the connection with server hub and upon response handles how to update the UI (comments should be sufficient explanation):</p>

<pre><code class="language-javascript">$(document).ready(function () {

    //Get the Hub
    var progress = $.connection.progressHub;

    //callback for broadcasted messages
    progress.client.updateProgress = function (percentage) {
        //update the progress bar
        $("#progress-bar").css('width', ''+ percentage +'%');
        $("#progress-bar").html('' + percentage + '%');

        //if it has completed then wait 2 secs and reset back
        if (percentage === 100) {
            setTimeout(function () {
                $("#start-processing").removeAttr('disabled');
                $("#progress-bar").css('width', '0%');
                $("#progress-bar").html('0%');
            }, 2000);
        }
    }

    $("#start-processing").click(function (e) {
        //disable the button
        $(this).attr("disabled", "disabled");

        //when connection to hub is done, invoke server-side send method
        $.connection.hub.start().done(function () {
            progress.server.send();
        });
    });

});
</code></pre>

<p>Try out the result <a href="http://realtimeprogerss.apphb.com">here</a>. Needless to say, I have more to learn here but my current day to day work does not even come close to this. But thought to try it out, just out of curiosity.</p>

			</div>

			
			
				<div class="posttags_pixel">

					<p><span class="icon-tag"></span> <a href="../tag/signalr/index.html">signalr</a></p>

				</div>

			

			

		</article>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'dev-ibrahim'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	

	

</main>

<footer class="footer_pixel">

	<p class="subscribe_pixel"><a class="icon-rss" target="_blank" href="../rss/index.html">

	</a></p>

	<div class="footertext_pixel">

		<p>All content copyright <a href="../index.html"></a> &copy; 2013 &bull; All rights reserved.</p>

	</div>

	<div class="footertext_pixel">

		<p>Proudly published with <a class="icon-ghost" href="http://tryghost.org" target="_blank">Ghost</a></p>
		<p>Theme: <a class="icon-github-circled" href="https://github.com/Skepton/Pixelpusher"></a></p>

	</div>

</footer>

		</div>

		<script src="../public/jquery.js"></script>
		<script src="../assets/js/prism.js"></script>
		<script src="../assets/js/fittext.js"></script>

		

		

		<script type="text/javascript">

			$(window).load(function(){

				if($('.postcontent_pixel p').eq(0).find('img').length){

					$('.postcontent_pixel p').eq(0).find('img').hide();

				}

			});

			$(document).ready(function(){

				if($('.postcontent_pixel p').eq(0).find('img').length){

					var source = $('.postcontent_pixel p').eq(0).find('img').attr('src');

					if($('.cover_pixel').length <= 0){

						$('.header_pixel').append('<img class="cover_pixel" src="http://127.0.0.1:2368/real-time-progress-with-signalr/'+source+'" alt="header">');

					}else{

						$('.cover_pixel').attr('src', source);

					}

					$('.postcontent_pixel p').eq(0).remove();

				}

				$('.blogdescription_pixel').remove();
				$('.blogtitle_pixel a').remove();

				$(".article_pixel img").load(function() {

					$(window).trigger('resize');
				  
				}).each(function() {

				  if(this.complete) $(this).load();

				});

				(function($) {
					// Responsive videos
					var all_videos = $( 'iframe[src^="http://player.vimeo.com"], iframe[src^="http://www.youtube.com"], iframe[src^="//www.youtube.com"], object, embed' );

					all_videos.each(function() {
						var el = $(this);

						el
							.attr( 'data-aspectRatio', el.height() / el.width() )
							.attr( 'data-oldWidth', el.attr( 'width' ) );
					} );
					
					$(window)
						.resize( function() {
							all_videos.each( function() {
								var el = $(this),
									newWidth = el.parents( '.postcontent_pixel' ).innerWidth(),
									oldWidth = el.attr( 'data-oldWidth' );
									el
										.removeAttr( 'height' )
										.removeAttr( 'width' )
										.width( newWidth )
								    		.height( newWidth * el.attr( 'data-aspectRatio' ) );
							} );
						} )
						.resize();
				})(jQuery);

				$(window).trigger('resize');

			});

			$(window).resize(function(){

				if($('.wrapper_pixel').height()<$(window).height()-$('.footer_pixel').height()){

					$('.footer_pixel').css('position','absolute');

				}else{$('.footer_pixel').css('position','relative');}

				$('.cover_pixel').on('load',function(){

					var header_height = $(this).height();
					var parent_height = $('.header_pixel').outerHeight();

					var height_complete = '-'+(header_height-parent_height)/2+'px';

					if((header_height-parent_height)/2 <= 0){height_complete = '0px';}

					$(this).css('margin-top',height_complete);

				}).each(function() {

					if(this.complete) $(this).load();

				});

				$('.postfooter_pixel address').css('height',$('.authorbio_pixel').outerHeight());
				$('.sharepost_pixel').css('height',$('.authorbio_pixel').outerHeight());

				jQuery(".postheader_pixel h1").fitText(1.1, { minFontSize: '40px', maxFontSize: '90px' });

			});

			$(window).scroll(function(){

				if($(this).scrollTop() > 50 && $(window).width() > 500 && $(window).height() > 500){
			
					jQuery(".blogtitle_pixel a").fitText(1.5, { minFontSize: '20px', maxFontSize: '32px' });

					$('.article_pixel').css('margin-top',$('.header_pixel').height()+230);

					$('.header_pixel').addClass('small');

					$('.article_pixel').css('margin-top',$('.header_pixel').height()+230);


				}else if($(this).scrollTop() <= 50){

					jQuery(".blogtitle_pixel a").fitText(1.2, { minFontSize: '20px', maxFontSize: '75px' });

					$('.article_pixel').css('margin-top',0);

					$('.header_pixel').removeClass('small');

				}

			});

		</script>

		

		<script type="text/javascript">

			$(document).ready(function(){

				$(window).trigger('resize');

				$(document).trigger('scroll');

				jQuery(".blogtitle_pixel a").fitText(1.2, { minFontSize: '20px', maxFontSize: '75px' });

			});

		</script>

	</body>
	

</html>